<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Генерация</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.js"></script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js" integrity="sha256-yr4fRk/GU1ehYJPAs8P4JlTgu0Hdsp4ZKrx8bDEDC3I=" crossorigin="anonymous"></script>
    <script type="text/javascript" charset="utf-8">
    $(document).ready(function(){
        namespace = '/';
        var socket = io.connect('http://' + document.domain + ':' + location.port + namespace);

    socket.on('connect', function(){
        socket.emit('connection', {connection_confirmation: 'you are connected to the socket!'});
    });

    socket.on('progress_update', function(res) {
        var value = res.ratio
        $('#progress_main').progress({
          percent: value,
          label: 'ratio',
          text: {
                  ratio: value + ' %'
                }
        });
    });

    $("#btn_start").click(function() {
          socket.emit('submit_result', {text: $('#emit_text').val()});
          alert("Start emit");
        });

    // Vertical menu
    $('.ui.sidebar').sidebar({context: $('.bottom.segment')})
                    .sidebar('attach events', '.menu .item');

    // Star rating
    $('.special.card .image').dimmer({on: 'hover'});
    $('.star.rating').rating();
    $('.card .dimmer').dimmer({on: 'hover'});

    });
    </script>
</head>
<body>
    <script>
<!--        function when_will_result() {-->
<!--            $.ajax({-->
<!--                type: 'POST',-->
<!--                url: '/task',-->
<!--                data: $('form').serialize(),-->
<!--                success: function(response, data) {-->
<!--                         console.log('SUCCESS when_will_result');-->
<!--                         console.log(data);-->
<!--                         },-->
<!--                error: function(error) {-->
<!--                       console.log('ERROR when_will_result');-->
<!--                       }-->
<!--            });-->
<!--        }-->
    </script>


<!--Test-->
<!--{% if message %}-->
<!--<p>{{ message }}</p>-->
<!--{% endif %}-->

<div class="ui container">
    <div class="ui top attached demo menu">
      <a id = "toggle" class="item"><i class="sidebar icon"></i> Меню </a>
        </div>
        <div class="ui bottom attached segment pushable">
          <div class="ui inverted labeled icon left inline vertical sidebar menu" style="">
            <a class="item"><i class="home icon"></i> Главная </a>
            <a class="item"><i class="calendar icon"></i> История </a>
          </div>
          <div class="pusher">
            <div class="ui basic segment">

                <h2 class="ui header">
                  <div class="content">Поиск <div class="sub header">Введите часть фразы </div>
                  </div>
                </h2>

                <form id="emit" action="/task" method = 'POST'>
                 <div class="ui action left icon input">
                  <i class="search icon"></i>
                  <input type="text" id="emit_text" name="emit_text" placeholder="Ваш текст..." size="50">
<!--                  <button type="button" onclick="when_will_result();" id="btn_start" class="ui teal button">Искать</button>-->
                  <button type="button" id="btn_start" class="ui teal button">Искать</button>
                 </div>
                </form>

                <h2 class="ui header">Результат <div class="sub header">Ожидайте пока процесс формирования текстов завершится</div>
                </h2>

                <div class="ui active progress" id="progress_main" data-value="0" data-total="100">
                  <div class="bar">
                    <div class="progress"></div>
                  </div>

<!--                  <div class="label">Uploading Files</div>-->
                </div>

<!--                Result table-->
                <table class="ui celled padded table">
                  <thead>
                    <th>Текст</th>
                    <th>Качество</th>

                  </tr></thead>
                  <tbody>
                    <tr>
                      <td>Отправьте заявку на открытие расчетного счета . Мы перезвоним вам или составим договор и полюбуемся)</td>

                      <td>
                        <div class="ui star rating" data-rating="3" data-max-rating="3"></div>
                      </td>
                    </tr>

                    <tr>
                      <td>Карта сберегательная - Золотая карта Сбербанка россии. Банковская карточкатации рубля%. Бесплатный сыр только вокруг."</td>

                      <td>
                        <div class="ui star rating" data-rating="1" data-max-rating="3"></div>
                      </td>
                    </tr>

                  <tr>
                      <td>Откройте расчетный счет в Сбербанке и пользуйтесь расчетным счетом, пока не поздно.</td>

                      <td>
                        <div class="ui star rating" data-rating="2" data-max-rating="3"></div>
                      </td>
                  </tr>

                  </tbody>
                  <tfoot>
                    <tr><th colspan="5">
                      <div class="ui right floated pagination menu">
                        <a class="icon item">
                          <i class="left chevron icon"></i>
                        </a>
                        <a class="item">1</a>
                        <a class="item">2</a>
                        <a class="item">3</a>
                        <a class="item">4</a>
                        <a class="icon item">
                          <i class="right chevron icon"></i>
                        </a>
                      </div>
                    </th>
                  </tr></tfoot>
                </table>

            </div>
          </div>

        </div>
</div>
</body>
</html>